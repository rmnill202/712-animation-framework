(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["update_3"],{"456d":function(e,t,n){var i=n("4bf8"),a=n("0d58");n("5eda")("keys",function(){return function(e){return a(i(e))}})},"5eda":function(e,t,n){var i=n("5ca1"),a=n("8378"),r=n("79e5");e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],s={};s[e]=t(n),i(i.S+i.F*r(function(){n(1)}),"Object",s)}},"7f7f":function(e,t,n){var i=n("86cc").f,a=Function.prototype,r=/^\s*function ([^ (]*)/,s="name";s in a||n("9e1e")&&i(a,s,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},"9c09":function(e,t,n){"use strict";var i=n("b64c"),a=n.n(i);a.a},a481:function(e,t,n){"use strict";var i=n("cb7c"),a=n("4bf8"),r=n("9def"),s=n("4588"),o=n("0390"),l=n("5f1b"),c=Math.max,h=Math.min,u=Math.floor,m=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,d=function(e){return void 0===e?e:String(e)};n("214f")("replace",2,function(e,t,n,f){return[function(i,a){var r=e(this),s=void 0==i?void 0:i[t];return void 0!==s?s.call(i,r,a):n.call(String(r),i,a)},function(e,t){var a=f(n,e,this,t);if(a.done)return a.value;var u=i(e),m=String(this),p="function"===typeof t;p||(t=String(t));var y=u.global;if(y){var g=u.unicode;u.lastIndex=0}var w=[];while(1){var _=l(u,m);if(null===_)break;if(w.push(_),!y)break;var x=String(_[0]);""===x&&(u.lastIndex=o(m,r(u.lastIndex),g))}for(var b="",M=0,j=0;j<w.length;j++){_=w[j];for(var k=String(_[0]),A=c(h(s(_.index),m.length),0),F=[],P=1;P<_.length;P++)F.push(d(_[P]));var O=_.groups;if(p){var S=[k].concat(F,A,m);void 0!==O&&S.push(O);var z=String(t.apply(void 0,S))}else z=v(k,m,A,F,O,t);A>=M&&(b+=m.slice(M,A)+z,M=A+k.length)}return b+m.slice(M)}];function v(e,t,i,r,s,o){var l=i+e.length,c=r.length,h=p;return void 0!==s&&(s=a(s),h=m),n.call(o,h,function(n,a){var o;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,i);case"'":return t.slice(l);case"<":o=s[a.slice(1,-1)];break;default:var h=+a;if(0===h)return n;if(h>c){var m=u(h/10);return 0===m?n:m<=c?void 0===r[m-1]?a.charAt(1):r[m-1]+a.charAt(1):n}o=r[h-1]}return void 0===o?"":o})}})},a748:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Assignment 3 - Motion Capture")]),n("h2",[e._v("Results")]),n("MocapFramework"),n("h2",[e._v("Summary")]),e._m(0)],1)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{"text-align":"left"}},[n("div",{staticClass:"update-text"},[e._v(" \n      Chaining rotations properly is a pain. \n    ")])])}],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticStyle:{width:"1100px",height:"800px",margin:"auto"},attrs:{id:"three-js-div"}}),n("button",{on:{click:function(t){return e.togglePausePlay()}}},[e._v(e._s(e.isPaused?"Play":"Pause"))]),n("button",{on:{click:function(t){return e.restartAnimation()}}},[e._v("Restart")]),n("input",{attrs:{type:"file"},on:{change:e.animFileChosen}}),n("div",[e._v("\n    Speed rate: (1.0 being normal) "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.speed_rate,expression:"speed_rate"}],domProps:{value:e.speed_rate},on:{input:function(t){t.target.composing||(e.speed_rate=t.target.value)}}})])])},s=[],o=(n("ac4d"),n("8a81"),n("ac6a"),n("7fed")),l=(n("5d44"),n("7f7f"),n("9a04")),c=n("75fc"),h=(n("28a5"),n("456d"),n("a481"),function e(t,n,i,a,r){var s=-1==t?r[a].trim().replace("ROOT ",""):r[a].trim().replace("JOINT ",""),o=a+2,l=a+3,c=a+4,h=u(r[o].trim()),p=m(r[l].trim(),n);n+=Object.keys(p).length,i.push({name:s,parent:t,offset:h,channels:p});var d=i.length-1,f=r[c].trim();if("End Site"==f)return i.push({name:"End Site",parent:d,offset:u(r[c+2].trim()),channels:{}}),{input_index:c+5,motion_index:n};var v=!1;while(!v){var y=e(d,n,i,c,r);if(n=y.motion_index,c=y.input_index,"}"==r[c].trim()){c+=1,v=!0;break}}return{input_index:c,motion_index:n}}),u=function(e){var t=e.split("\t");return[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])]},m=function(e,t){for(var n=e.split("\t"),i=parseInt(n[1]),a={},r=0;r<i;r++)a[n[r+2]]=r+t;return a},p=function(e){var t=e.split("\n"),n=[];return h(-1,0,n,1,t),n},d=function(e,t){for(var n=e.split("\n"),i=parseFloat(n[2].split(":")[1]),a=[],r=3;r<n.length-1;r++)""!=n[r].trim()&&"\n"!=n[r].trim()&&a.push({start:(r-3)*i,isEnd:!1,data:f(n[r].split("\t").map(function(e){return parseFloat(e)}),t)});return a[a.length-1].isEnd=!0,a},f=function(e,t){var n=new Array(t.length),i=new Array(t.length),a=new Array(t.length),r=Object(l["a"])(o["Vector3"],Object(c["a"])(t[0].offset));r.add(new o["Vector3"](e[t[0].channels["Xposition"]],e[t[0].channels["Yposition"]],e[t[0].channels["Zposition"]])),i[0]=r;var s=v(e[t[0].channels["Xrotation"]]*Math.PI/180,e[t[0].channels["Yrotation"]]*Math.PI/180,e[t[0].channels["Zrotation"]]*Math.PI/180);a[0]=s,n[0]={position:r,rotation:s};for(var h=1;h<t.length;h++){var u=t[h],m=(u.name,a[u.parent].clone());m.multiply(v(e[t[h].channels["Xrotation"]]*Math.PI/180,e[t[h].channels["Yrotation"]]*Math.PI/180,e[t[h].channels["Zrotation"]]*Math.PI/180)),a[h]=m;var p=i[u.parent].clone(),d=a[u.parent],f=Object(l["a"])(o["Vector3"],Object(c["a"])(u.offset));f.applyQuaternion(d),f.add(p),i[h]=f,n[h]={position:f,rotation:d}}return n},v=function(e,t,n){var i=(new o["Quaternion"]).setFromAxisAngle(new o["Vector3"](1,0,0),e),a=(new o["Quaternion"]).setFromAxisAngle(new o["Vector3"](0,1,0),t),r=(new o["Quaternion"]).setFromAxisAngle(new o["Vector3"](0,0,1),n);return r.multiply(i).multiply(a),r.normalize()},y={parseBVH:function(e){var t=p(e.split("MOTION")[0]),n=d(e.split("MOTION")[1],t);return{skeleton:t,frames:n}}},g=n("d225"),w=n("b0b4"),_=function(){function e(t,n){Object(g["a"])(this,e),this.joints=t,this.frames=n,this.isPlaying=!1,this.hasEnded=!1,this.timeline=0,this.frameIndex=0,this.updateMeshes(this.frames[0])}return Object(w["a"])(e,[{key:"playing",value:function(){return this.isPlaying&&!this.hasEnded}},{key:"restart",value:function(){this.isPlaying=!1,this.timeline=0,this.frameIndex=0,this.hasEnded=!1,this.updateMeshes(this.frames[0])}},{key:"play",value:function(){this.hasEnded||(this.isPlaying=!0)}},{key:"pause",value:function(){this.isPlaying=!1}},{key:"getFrame",value:function(e){if(this.playing()){this.timeline;this.timeline+=e;var t=this.frames[this.frameIndex];while(!t.isEnd&&this.timeline>=this.frames[this.frameIndex+1].start)t=this.frames[++this.frameIndex];this.updateMeshes(t),t.isEnd&&(this.isPlaying=!1,this.hasEnded=!0,this.timeline=t.start)}}},{key:"updateMeshes",value:function(e){for(var t=0;t<this.joints.length;t++){var n=this.joints[t],i=this.joints[t].mesh_joint,a=e.data[t].position;if(i.position.x=a.x,i.position.y=a.y,i.position.z=a.z,i.setRotationFromQuaternion(e.data[t].rotation),n.mesh_segment){var r=this.joints[n.parent].mesh_joint;n.mesh_segment.geometry.vertices[0].x=i.position.x,n.mesh_segment.geometry.vertices[0].y=i.position.y,n.mesh_segment.geometry.vertices[0].z=i.position.z,n.mesh_segment.geometry.vertices[1].x=r.position.x,n.mesh_segment.geometry.vertices[1].y=r.position.y,n.mesh_segment.geometry.vertices[1].z=r.position.z,n.mesh_segment.geometry.verticesNeedUpdate=!0}}}},{key:"alt_slerp",value:function(e,t){var n=this.lerp_find_u(e.start,t.start,this.timeline),i=new o["Quaternion"],a=new o["Quaternion"];return i.setFromAxisAngle(new o["Vector3"](e.xa,e.ya,e.za).normalize(),e.thetaRad),a.setFromAxisAngle(new o["Vector3"](t.xa,t.ya,t.za).normalize(),t.thetaRad),i.slerp(a,n)}},{key:"rotation_slerp",value:function(e,t){var n=this.lerp_find_u(e.start,t.start,this.timeline),i=new o["Quaternion"],a=new o["Quaternion"];i.setFromAxisAngle(new o["Vector3"](e.xa,e.ya,e.za).normalize(),e.thetaRad),a.setFromAxisAngle(new o["Vector3"](t.xa,t.ya,t.za).normalize(),t.thetaRad),i.normalize(),a.normalize();var r=i.dot(a);r<=0&&(i.set(-i.x,-i.y,-i.z,-i.w),r=-r);var s=Math.acos(r),h=Math.sin(s),u=Math.sin((1-n)*s)/h,m=Math.sin(n*s)/h,p=Object(l["a"])(o["Vector4"],Object(c["a"])(i.toArray()));p.multiplyScalar(u);var d=Object(l["a"])(o["Vector4"],Object(c["a"])(a.toArray()));return d.multiplyScalar(m),Object(l["a"])(o["Quaternion"],Object(c["a"])(p.add(d).toArray()))}},{key:"translation_lerp",value:function(e,t){var n=this.lerp_find_u(e.start,t.start,this.timeline);return{x:this.lerp(e.x,t.x,n),y:this.lerp(e.y,t.y,n),z:this.lerp(e.z,t.z,n)}}},{key:"lerp",value:function(e,t,n){return e+n*(t-e)}},{key:"lerp_find_u",value:function(e,t,n){return(n-e)/(t-e)}}]),e}(),x={data:function(){return{camera:null,scene:null,renderer:null,mesh:null,sceneObjects:[],speed_rate:1,threeClock:null,originTime:0,lastFrameTime:0,endTime:2e4,isPaused:!0,mocap:null,bodyMeshes:[]}},methods:{init_threejs:function(){var e=document.getElementById("three-js-div");this.scene=new o["Scene"],this.camera=new o["PerspectiveCamera"](75,e.clientWidth/e.clientHeight,.01,1e4),this.camera.position.z=-310,this.camera.position.y=150,this.camera.position.x=-270,this.camera.rotateY(Math.PI),this.camera.rotateY(.9),this.camera.rotateX(-.2),this.setupScene(),this.renderer=new o["WebGLRenderer"]({antialias:!0}),this.renderer.setSize(e.clientWidth,e.clientHeight),this.originTime=performance.now(),this.lastFrameTime=this.originTime,this.threeClock=new o["Clock"],e.appendChild(this.renderer.domElement)},setupScene:function(){var e=new o["BoxGeometry"](3e3,1,3e3),t=new o["MeshNormalMaterial"],n=new o["Mesh"](e,t);n.position.y=-100,this.scene.add(n)},updateScene:function(e){this.mocap&&this.mocap.getFrame(e*this.speed_rate)},animationLoop:function(e){requestAnimationFrame(this.animationLoop);this.originTime;this.originTime=e,this.updateScene(this.threeClock.getDelta()),this.renderer.render(this.scene,this.camera)},animFileChosen:function(e){var t=this,n=e.target.files[0],i=new FileReader;i.readAsText(n),i.onload=function(e){return t.parseBvhFile(e.target.result)}},parseBvhFile:function(e){var t=y.parseBVH(e),n=!0,i=!1,a=void 0;try{for(var r,s=this.bodyMeshes[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;this.scene.remove(l),l.geometry.dispose(),l.material.dispose()}}catch(b){i=!0,a=b}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}this.bodyMeshes=[];for(var c=t.skeleton,h=0;h<c.length;h++){var u=new o["Mesh"](new o["BoxGeometry"](5,5,5),new o["MeshNormalMaterial"]);if(c[h].mesh_joint=u,this.bodyMeshes.push(u),-1!=c[h].parent){var m=new o["Geometry"];m.vertices.push(new o["Vector3"](0,0,0),new o["Vector3"](1,1,1));var p=new o["Line"](m,new o["LineBasicMaterial"]({color:255}));c[h].mesh_segment=p,this.bodyMeshes.push(p)}}this.mocap=new _(c,t.frames);var d=!0,f=!1,v=void 0;try{for(var g,w=this.bodyMeshes[Symbol.iterator]();!(d=(g=w.next()).done);d=!0){var x=g.value;this.scene.add(x)}}catch(b){f=!0,v=b}finally{try{d||null==w.return||w.return()}finally{if(f)throw v}}},restartAnimation:function(){this.mocap&&(this.mocap.restart(),this.isPaused=!0)},togglePausePlay:function(){this.mocap&&(this.isPaused?(this.mocap.play(),this.isPaused=!this.mocap.playing()):(this.mocap.pause(),this.isPaused=!0))}},mounted:function(){this.init_threejs(),this.animationLoop()}},b=x,M=n("2877"),j=Object(M["a"])(b,r,s,!1,null,null,null),k=j.exports,A={components:{MocapFramework:k}},F=A,P=(n("9c09"),Object(M["a"])(F,i,a,!1,null,null,null));t["default"]=P.exports},b64c:function(e,t,n){}}]);
//# sourceMappingURL=update_3.52c51d71.js.map